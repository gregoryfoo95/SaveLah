<%- include('../partials/header') %>


    <h2>All Transactions</h2>
    <a href="/dashboard">Dashboard</a>
    <%=msg%>
        <nav>
            <form action="/transactions" method="POST">
                <label>Category:</label>
                <select name="category_id">
                    <%- categories.map(c=> `<option value=${c._id}>${c.category_name}</option>`)%>
                </select>
                <label>Date: <input type="date" id="date" name="date"> </label>
                <script>
                    $('#date').val(new Date().toJSON().slice(0, 10));
                </script>
                <label>Amount: $<input name="amount" type="number" placeholder="No negative amount please" step="0.01" min="0" pattern="^\s*$^[+]?([0-9]+(?:[\.][0-9]*)?|\.[0-9]+)$"  /></label>
                <input type="submit" />
            </form>
        </nav>

        <table id="transactionList">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Category</th>
                    <th>Amount</th>
                </tr>

            </thead>
            <tbody>
                <% transactions.forEach((t,i) => { %>
                    <tr>
                        <td>
                            <%=t.date.toString().slice(0,15) %>
                        </td>
                        <td>
                            <%=t.category_id.category_name%>
                        </td>
                        <td>
                            <%=t.amount%> 
                        </td>
                        <td>
                            <form action="/transactions/<%=t._id%>/edit" method="get">
                                <button type="submit">Edit</button>
                            </form>
                        </td>
                        <td>
                            <form action="/transactions/<%=t._id%>/?_method=DELETE" method="post">
                                <button type="submit">Delete</button>
                            </form>
                        </td>
                    </tr>
                <% }) %>
            </tbody>
        </table>

        <%- include('../partials/footer') %>